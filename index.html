<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reader</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTcgNUgxNVYyN0g3VjVaIiBmaWxsPSIjRjVGN0Y5IiBzdHJva2U9IiM0QTU1NjgiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+CjxwYXRoIGQ9Ik0xNyA1SDI1VjI3SDE3VjVaIiBmaWxsPSIjRkZGRkZGIiBzdHJva2U9IiM0QTU1NjgiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+CjxwYXRoIGQ9Ik0yMCA0VjEwIiBzdHJva2U9IiM4ODdBRjUiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNhcD0icm91bmQiLz4KPC9zdmc+"/>
    <link rel="stylesheet" href="reader.css">
</head>
<body>
    <!-- 设置面板遮罩 -->
    <div class="settings-mask" id="settingsMask"></div>
    
    <!-- 章节面板遮罩 -->
    <div class="chapters-mask" id="chaptersMask"></div>

    <!-- 应用容器 -->
    <div class="app-container">
        <!-- 阅读区域 -->
        <div class="reading-area glass">
            <!-- 文件上传区域 -->
            <div class="file-upload-area" id="fileUploadArea">
                <div class="upload-icon">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                        <polyline points="10 9 9 9 8 9"/>
                    </svg>
                </div>
                <h2 style="font-weight: 600; margin-bottom: 8px;">拖放TXT文件到此处或点击选择文件</h2>
                <p style="color: var(--secondary-text); max-width: 400px; line-height: 1.6;">仅支持UTF-8编码的TXT文件</p>
                <input type="file" id="fileInput" accept=".txt" style="display: none;">
                <button class="btn btn-primary" id="selectFileBtn">选择TXT文件</button>
                
                <!-- 历史记录 -->
                <div id="historyList" style="margin-top: 30px; width: 100%; max-width: 400px; display: none;">
                    <h3 style="font-size: 14px; color: var(--secondary-text); margin-bottom: 10px; text-align: left;">最近阅读</h3>
                    <div id="historyItems"></div>
                </div>
            </div>

            <!-- 阅读内容区域 -->
            <div class="content-container" id="contentContainer" style="display: none;">
                <!-- 内容区域 -->
                <div class="content" id="content">
                    <!-- 内容将通过JavaScript动态生成 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 章节导航按钮 - 左上角 -->
    <div class="corner-control top-left">
        <button class="corner-btn glass" id="chapterNavBtn" title="章节导航">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="12" x2="21" y2="12"/>
                <line x1="3" y1="6" x2="21" y2="6"/>
                <line x1="3" y1="18" x2="21" y2="18"/>
            </svg>
        </button>
    </div>
    
    <!-- 设置按钮 - 右上角 -->
    <div class="corner-control top-right">
        <button class="corner-btn glass" id="settingsBtn" title="设置">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 15a3 3 0 100-6 3 3 0 000 6z"/>
                <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
            </svg>
        </button>
    </div>
    
    <!-- 翻页按钮 - 右下角 -->
    <div class="corner-control bottom-right">
        <div class="page-control-group glass" id="pageControlGroup">
            <button class="page-btn" id="prevPageBtn" title="上一章">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"/>
                </svg>
            </button>
            
            <!-- 章节标题容器 -->
            <div class="chapter-title-container">
                <div class="chapter-title-wrapper">
                    <div class="chapter-title" id="chapterTitle">暂无章节</div>
                </div>
            </div>
            
            <button class="page-btn" id="nextPageBtn" title="下一章">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="9 18 15 12 9 6"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- 设置面板 -->
    <div class="settings-panel glass collapsed" id="settingsPanel">
        <!-- 设置面板头部 -->
        <div class="settings-header">
            <h2 class="settings-title">设置</h2>
            <div class="settings-close" id="settingsClose">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </div>
        </div>
        
        <!-- 设置内容容器 -->
        <div class="settings-content">
            <!-- 文字样式 -->
            <div class="settings-section">
                <h3 class="section-title">文字样式</h3>
                
                <div class="control-group">
                    <label class="control-label">字体大小: <span class="control-value" id="fontSizeValue">16px</span></label>
                    <div class="slider-container">
                        <input type="range" class="slider" id="fontSize" min="12" max="20" value="16" step="1">
                    </div>
                </div>
                
                <div class="control-group">
                    <label class="control-label">字重: <span class="control-value" id="fontWeightValue">400</span></label>
                    <div class="slider-container">
                        <input type="range" class="slider" id="fontWeight" min="400" max="900" value="400" step="100">
                    </div>
                </div>
                
                <div class="control-group">
                    <label class="control-label">字间距: <span class="control-value" id="letterSpacingValue">0px</span></label>
                    <div class="slider-container">
                        <input type="range" class="slider" id="letterSpacing" min="0" max="20" value="0" step="1">
                    </div>
                </div>
                
                <button class="btn" id="resetTextStyle">重置文字样式</button>
            </div>
            
            <!-- 段落样式 -->
            <div class="settings-section">
                <h3 class="section-title">段落样式</h3>
                
                <div class="control-group">
                    <label class="control-label">行间距: <span class="control-value" id="lineHeightValue">1.6</span></label>
                    <div class="slider-container">
                        <input type="range" class="slider" id="lineHeight" min="10" max="30" value="16" step="1">
                    </div>
                </div>
                
                <div class="control-group">
                    <label class="control-label">段落间距: <span class="control-value" id="paragraphSpacingValue">1.0em</span></label>
                    <div class="slider-container">
                        <input type="range" class="slider" id="paragraphSpacing" min="5" max="30" value="10" step="1">
                    </div>
                </div>
                
                <button class="btn" id="resetParagraphStyle">重置段落样式</button>
            </div>
            
            <!-- 字体设置 -->
            <div class="settings-section">
                <h3 class="section-title">字体设置</h3>
                
                <div class="font-upload">
                    <input type="file" id="fontUpload" accept=".ttf,.otf,.woff,.woff2" class="font-upload-input">
                    <label for="fontUpload" class="font-upload-label">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        上传字体文件 (TTF/OTF/WOFF)
                    </label>
                    
                    <!-- 字体预览区域 -->
                    <div class="font-preview" id="fontPreview" style="display: none;">
                        <div class="font-preview-text" id="fontPreviewText">字体预览：中文字体示例</div>
                        <div class="font-preview-name" id="fontPreviewName"></div>
                    </div>
                    
                    <button class="btn" id="resetFont">恢复默认字体</button>
                </div>
            </div>
            
            <!-- 存储管理 -->
            <div class="settings-section">
                <h3 class="section-title">存储管理</h3>
                <div class="storage-controls">
                    <button class="btn" id="clearNovelData" title="清除所有小说数据">清除小说数据</button>
                    <button class="btn" id="clearSettings" title="清除所有设置">清除设置</button>
                    <button class="btn" id="exportData" title="导出所有数据">导出数据</button>
                    <button class="btn" id="importData" title="导入数据" style="display: none;">导入数据</button>
                </div>
                <div class="storage-info" id="storageInfo">
                    正在计算存储使用情况...
                </div>
            </div>
            
            <!-- 重置所有设置 -->
            <div class="settings-section">
                <button class="btn btn-primary" id="resetAllStyles">重置所有设置</button>
            </div>
        </div>
    </div>

    <!-- 章节面板 -->
    <div class="chapters-panel glass collapsed" id="chaptersPanel">
        <div class="chapters-header">
            <h2 class="chapters-title">章节列表</h2>
            <div class="chapters-close" id="chaptersClose">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </div>
        </div>
        
        <!-- 章节列表容器 -->
        <div class="chapters-list-container">
            <div class="chapters-list" id="chaptersList">
                <!-- 章节列表将通过JavaScript动态生成 -->
            </div>
        </div>
        
        <div class="chapters-info">
            共 <span id="chaptersCount">0</span> 章
        </div>
    </div>

    <!-- 加载遮罩 -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-animation">
            <div class="loading-block"></div>
            <div class="loading-block"></div>
            <div class="loading-block"></div>
        </div>
    </div>

    <!-- 提示条 -->
    <div class="toast" id="toast"></div>

    <script src="reader.js"></script>
</body>
</html>
